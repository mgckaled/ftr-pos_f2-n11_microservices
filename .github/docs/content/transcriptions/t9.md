# Transcrição: 9. Backend for Frontend

A gente já falou sobre a grande maioria dos conceitos voltados à parte de comunicação, à parte de compensação, tudo relacionado a como os microserviços vão se comunicar. Só que a gente falou pouco sobre como esses serviços vão ser consumidos, porque uma das maiores dificuldades que a gente tem quando a gente trabalha com microserviços entre todas as outras que eu já citei e que provavelmente desencorajaram você a utilizar microserviços no seu projetinho de final de semana com dois usuários, é que microserviços se tornam um desafio muito grande na parte de comunicação, mas se torna um desafio muito grande também na parte de consumo de dados, porque por mais que o front-end aqui a gente tenha o API Gateway, que ele centraliza todas as aquisições do front-end e separa ela entre os microserviços, a gente tem um desafio muito grande que é a parte de fazer um merge, a combinação de dados. Porque imagina nesse caso de pedidos e invoices, imagina que lá no back-end eu tenho uma tela que eu quero mostrar um array, uma listagem de todos os pedidos do usuário. Então, eu tenho lá o ID, a data que o pedido foi criado, mas que também retorne... É... Nessa... Nessa listagem, dados da nota fiscal. Então, por exemplo, retorne aqui... a invoice URL para o usuário conseguir fazer download dessa invoice diretamente. Veja que esse array aqui não é composto com dados que vêm de apenas um serviço. Ele é composto de dados que vêm de dois serviços diferentes, de orders e invoices. Só que cada um desses serviços aqui tem o seu próprio banco de dados. Então, como é que eu vou fazer isso? Uma alternativa seria lá no back-end, lá no front-end, eu fazer duas chamadas. Uma, primeiro, que eu busco todos os pedidos daquele cliente... E depois, para cada um desses pedidos aqui, eu tenho que buscar as invoices, a nota fiscal deles. Então, aqui teria que ter um for para cada um desses pedidos e aí buscar... a invoice daquela order. Só que aqui, acho que você já consegue perceber o quanto isso aqui é horrível, né? Vai dar muito problema, porque se eu tiver aqui 20 pedidos, eu vou ter que fazer 20 requisições pro banco pra buscar aquelas invoices. Daí tu pode pensar, tá, mas eu poderia ter uma rota É... Await... Get all order invoices from customer... Então, agora eu teria, na verdade, só duas requisições. Só que você entende que começa a ter que modelar o seu back-end... para, na verdade, a forma que o teu back-end precisa funcionar. Então, o teu back-end passa a ser não simplesmente um back-end, uma aplicação isolada, ele passa a ser um back-end para o teu front-end funcionar. E sim, é exatamente esse o conceito que a gente vai falar agora, que é o back-end for front-end. O back-end feito para o front-end funcionar. Só que, geralmente, o que a gente faz é não mudar o nosso próprio back-end. É criar um back-end separado. Então, ao invés de a gente ter invoice orders, a gente pode ter um terceiro serviço aqui, que é um serviço onde ele tem informações de toda a parte de compras do usuário. Então, se lá, purchases. E esse serviço purchases aqui é onde tem as rotas que vão retornar os dados da maneira que o front-end precisa. Então, nesse serviço de purchases, eu vou ter, por exemplo, await getOrders With invoices. E esse serviço aqui em si é quem vai se comunicar com cada um desses serviços aqui, usando um gRPC, pode ser HTTP também, mas pode ser um gRPC, buscando os dados de orders invoices desses clientes e trazendo ele já exatamente no formato que o meu front-end precisa. Então, isso aqui é o conceito de Backend for Frontend, que é muito utilizado quando a gente trabalha com microserviços. Aqui eu acabei não criando um exemplo no código, mas se você entrar aqui no site do Microservices.io e vir aqui e procurar por BFF ou Backend for Frontend, você vai ver exatamente isso sendo exibido aqui dentro. E como você vê, ele usa gRPC às vezes e por aí vai. Mas basicamente, geralmente é isso. Isso aqui é uma das formas de resolver. Não é a única forma que a gente tem de resolver esse problema, essa problemática de buscar dados de mais serviços, mas a outra forma eu vou te mostrar na próxima aula.
